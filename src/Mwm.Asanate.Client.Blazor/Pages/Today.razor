@inherits Fluxor.Blazor.Web.Components.FluxorComponent
@using Mwm.Asanate.Client.Blazor.Helpers;
@using Mwm.Asanate.Client.Blazor.Models.Tsks
@using Mwm.Asanate.Domain; 
@using Syncfusion.Blazor.Kanban
@using Syncfusion.Blazor.Popups
@using Syncfusion.Blazor.Buttons
@using Syncfusion.Blazor.Inputs
@page "/"

<h3 class="text-center mb-3">Today
     @if (IsLoading()) {
        <div class="spinner-border" role="status">
            <span class="sr-only">Loading...</span>
        </div>
     }
</h3>


<div class="d-flex flex-row justify-content-center">
    @if (HasErrors()) {
        <span>Whoops! Looks like an issue occurred loading TskModels</span>
    } else if (HasValues()) {
        <SfKanban @ref="KanbanBoard" KeyField="StatusName" DataSource="@TskModels">
            <KanbanColumns>
                @foreach (var statusName in StatusNames) {
                    <KanbanColumn HeaderText="@statusName" KeyField="@statusName.ToKeyFields()"></KanbanColumn>
                }
            </KanbanColumns>
            <KanbanCardSettings HeaderField="Name" ContentField="Notes"></KanbanCardSettings>
          
            <KanbanSwimlaneSettings KeyField="CompanyName" TextField="CompanyName" SortDirection="SortDirection.Ascending">
            </KanbanSwimlaneSettings>
            <KanbanEvents ActionComplete="@ActionCompleteHandler" TValue="Models.Tsks.TskModel"></KanbanEvents>
            <KanbanEvents DragStop="@DragStopHandler" TValue="Models.Tsks.TskModel"></KanbanEvents>
            <KanbanEvents CardClick="@CardClickHandler" TValue="Models.Tsks.TskModel"></KanbanEvents>
            <KanbanEvents CardDoubleClick="@CardDoubleClickHandler" TValue="Models.Tsks.TskModel"></KanbanEvents>
            <KanbanEvents DialogOpen="@DialogOpenHandler" TValue="Models.Tsks.TskModel"></KanbanEvents>
        </SfKanban>
    }

</div>

<SfDialog Height="75%" Width="435px" Target="#target" ShowCloseIcon="true" @bind-Visible="@IsDialogShowing">
    <DialogTemplates>
        <Header>
            <span class="e-avatar template-image e-avatar-xsmall e-avatar-circle"></span>
            <div id="template" title="Nancy" class="e-icon-settings">Nancy</div>
        </Header>
        <Content>
            <div class="dialogContent">
                <h2>@SelectedTskModel?.Name</h2>

              @*  <EditForm Model="@SelectedTskModel">
                     <DataAnnotationsValidator />
                     <ValidationSummary />
                     <div class="form-group">
                         <label for="first-name">Name:</label>
                         <SfTextBox ID="first-name"></SfTextBox>
                     </div>
                     <SfButton>Submit</SfButton>
                 </EditForm>*@
            </div>
        </Content>
        <FooterTemplate>
       @*     <SfTextBox ID="inVal" @bind-Value="@TextBoxValue" @ref="TextboxObj" Type="InputType.Text" Placeholder="Enter your message here!" />
            <button id="sendButton" @onclick="@SendBtnclicked" class="e-control e-btn e-primary" data-ripple="true">Send</button>*@
        </FooterTemplate>
    </DialogTemplates>
    <DialogEvents Closed="@DialogCloseHandler"></DialogEvents>
</SfDialog>




@*<SfKanban KeyField="CompanyName" DataSource="@TskModels">
        <KanbanColumns>
            @foreach (var companyName in TskModels.Select(t => t.CompanyName).Distinct()) {
                <KanbanColumn HeaderText="@companyName" KeyField="@companyName.ToKeyFields()">
                </KanbanColumn>
            }

        </KanbanColumns>
        <KanbanCardSettings HeaderField="Name" ContentField="Notes"></KanbanCardSettings>
        <KanbanSwimlaneSettings KeyField="StatusId" TextField="StatusName" SortDirection="SortDirection.Ascending">
        </KanbanSwimlaneSettings>

    </SfKanban>*@
