@inherits Mwm.MyQ.Client.Mud.Components.ModelConsumerComponent<TskModel, Tsk>
@using Mwm.MyQ.Client.Service.Models
@using Mwm.MyQ.Domain
@using MudBlazor
<MudCard Outlined="true"
         Class="m-2" 
         @ondblclick="@Edit">
    <!--Style="width: 300px;"-->
    <MudCardHeader Style="@HeaderStyle" Class="p-2">
        <CardHeaderContent>
            <MudGrid>
                @if (IncludeCompanyName) {
                    <MudItem xs="8">
                        <MudText Typo="Typo.h6" Color="Color.Surface">
                            @TskModel.CompanyName > @TskModel.InitiativeName
                        </MudText>
                    </MudItem>
                } else {
                    <MudItem xs="8">
                        <MudText Typo="Typo.h6" Color="Color.Surface">
                            @TskModel.InitiativeName 
                        </MudText>
                    </MudItem>
                }
                @if (@TskModel.InitiativeExternalLink != null) {
                    <MudItem xs="4" Class="justify-end">
                        <MudLink Target="_blank" 
                                 Href="@TskModel.InitiativeExternalLink" 
                                 Typo="Typo.body2">
                            @TskModel.InitiativeExternalId
                        </MudLink>
                    </MudItem>
                }
            </MudGrid>
            <MudText Typo="Typo.h5">@TskModel.Name</MudText>
        </CardHeaderContent>
    </MudCardHeader>
    @if (!string.IsNullOrEmpty(TskModel.Notes)) {
        <MudCardContent>
            <MudText>@TskModel.Notes</MudText>
            <MudDivider />
        </MudCardContent>
    }
    <MudCardActions>
        <MudGrid>
            <MudItem xs="5">
                @if (!string.IsNullOrEmpty(HourProgressDisplay)) {
                    <MudChip Size="Size.Medium" 
                             Variant="Variant.Text" 
                             Color="@Color.Info">
                        @HourProgressDisplay
                    </MudChip>
                }
            </MudItem>
            <MudItem xs="5" Class="d-flex justify-start">
                @if (!string.IsNullOrEmpty(DueDateDisplay)) {
                    <MudChip Size="Size.Medium" 
                             Variant="Variant.Text" 
                             Color="@DueDateCountColor">
                        @DueDateDisplay 
                        <MudChip Size="Size.Small" 
                             Variant="Variant.Outlined" 
                             Color="@DueDateCountColor">
                            @DueDateCount
                        </MudChip>
                    </MudChip>
                    @*<MudText Typo="Typo.h6"
                             Class="mt-2">
                        @DueDateDisplay
                    </MudText>
                    <MudChip Size="Size.Small" 
                             Variant="Variant.Text" 
                             Color="@DueDateCountColor">
                        @DueDateCount
                    </MudChip>*@
                }
            </MudItem>
            <MudItem xs="2" Class="d-flex justify-end">
                @if (TskModel.Status == Status.Done) {
                    <MudToggleIconButton @bind-Toggled="@IsArchived"
                         Icon="@Icons.Filled.Archive" 
                         Color="@Color.Default" 
                         Title="All Statuses"
                         Size="Size.Small" 
                         ToggledIcon="@Icons.Filled.Archive" 
                         ToggledColor="@Color.Success" 
                         ToggledTitle="Action Statuses" 
                         ToggledSize="Size.Small" />
                } else {
                    <MudToggleIconButton @bind-Toggled="@IsDone"
                         Icon="@Icons.Filled.CheckBox" 
                         Color="@Color.Default" 
                         Title="All Statuses"
                         Size="Size.Small" 
                         ToggledIcon="@Icons.Filled.CheckBox" 
                         ToggledColor="@Color.Success" 
                         ToggledTitle="Action Statuses" 
                         ToggledSize="Size.Small" />
                }

                <MudToggleIconButton @bind-Toggled="@IsInFocus"
                         Icon="@Icons.Filled.Biotech" 
                         Color="@Color.Default" 
                         Title="All Statuses"
                         Size="Size.Small" 
                         ToggledIcon="@Icons.Filled.Biotech" 
                         ToggledColor="@Color.Success" 
                         ToggledTitle="Action Statuses" 
                         ToggledSize="Size.Small" />
            </MudItem>
        </MudGrid>
    </MudCardActions>
</MudCard>
